(()=>{"use strict";var e={380:(e,t,r)=>{var o=r(555);const n=e=>{const t=document.querySelector(e);t.textContent="";for(let e=0;e<10;e+=1)for(let r=0;r<10;r+=1){const n=o.r.convertToAlphanumeric([e,r]),a=document.createElement("div");a.classList.add("square"),a.dataset.coordinate=n,t.appendChild(a)}},a=(e,t)=>{document.querySelector(e).querySelectorAll(".square").forEach((e=>{t.forEach((t=>{e.addEventListener(t.eventType,t.handler)}))}))},l=e=>{document.querySelector("#winner").textContent=`${e} won!`},c=e=>{document.querySelector(e).querySelectorAll(".square").forEach((e=>{e.className="square"}))};var s=r(776);(()=>{const e=(0,s.Br)(),t=(0,s.Br)(),r=(0,s.oP)("computer");let i=0,d=!0,u=!1,h=null;const p=n=>{if(!d){const a=n.target,c=a.dataset.coordinate;t.getAttackedCoordinates().includes(c)||(t.receiveAttack(c)?a.classList.add("hit"):a.classList.add("miss"),t.allShipsSunk()&&(h="You",l(h),o.U.toggleModal(document.querySelector(".modal.endgame"),"show")),(()=>{if(!d){const t=r.attack(e,r.lastHitCoordinate,r.currentDirection),n=e.receiveAttack(t),a=document.querySelector(`.gameboard.player [data-coordinate="${t}"]`);n?(a.classList.add("hit"),r.lastHitCoordinate=t,null===r.currentDirection&&(r.currentDirection="up")):!n&&r.lastHitCoordinate?a.classList.add("miss"):n||r.lastHitCoordinate||(a.classList.add("miss"),r.lastHitCoordinate=null,r.currentDirection=null),e.allShipsSunk()&&(h="The computer",l(h),o.U.toggleModal(document.querySelector(".modal.endgame"),"show"))}})())}},m=()=>{u=!u},g=[{eventType:"mouseover",handler:e=>{if(d){const t=e.target.dataset.coordinate,{length:r}=o.U.shipTypes[i],[n,a]=o.r.convertToIndices(t);Array.from({length:r},((e,t)=>{const r=u?n+t:n,l=u?a:a+t;return{initialSquare:document.querySelector(`.gameboard.initial [data-coordinate="${o.r.convertToAlphanumeric([r,l])}"]`)}})).forEach((({initialSquare:e})=>{e&&e.classList.add("hovered")}))}}},{eventType:"mouseleave",handler:()=>{document.querySelectorAll(".gameboard .hovered").forEach((e=>{e.classList.remove("hovered")}))}},{eventType:"click",handler:r=>{if(d){const n=r.target,{coordinate:a}=n.dataset,{length:l}=o.U.shipTypes[i],[c,h]=o.r.convertToIndices(a),p=Array.from({length:l},((e,t)=>[u?c+t:c,u?h:h+t])),m=(0,s._V)(l);if(e.placeShip(m,p))if(n.classList.add("placed"),p.forEach((([e,t])=>{document.querySelector(`[data-coordinate="${o.r.convertToAlphanumeric([e,t])}"]`).classList.add("placed"),document.querySelector(`.gameboard.initial [data-coordinate="${o.r.convertToAlphanumeric([e,t])}"]`).classList.add("placed")})),i+=1,i===o.U.shipTypes.length)d=!1,(()=>{for(const e of o.U.shipTypes){const{length:r}=e,n=(0,s._V)(r),a=10;let l,c=!1;for(;!c;){const e=Math.floor(Math.random()*a),o=Math.floor(Math.random()*a);u=Math.random()<.5,u&&e+r<=a?l=Array.from({length:r},((t,r)=>[e+r,o])):!u&&o+r<=a&&(l=Array.from({length:r},((t,r)=>[e,o+r]))),l&&(c=t.placeShip(n,l))}const i=t.getShipCoordinates(n);for(const[e,t]of i){const r=o.r.convertToAlphanumeric([e,t]);document.querySelector(`.gameboard.computer [data-coordinate="${r}"]`).classList.add("placed")}}})(),setTimeout((()=>{o.U.toggleModal(document.querySelector(".modal.initial"),"hide")}),500);else{const e=o.U.shipTypes[i].type;document.querySelector(".ship-type").textContent=e}}}}];return{init:()=>{o.U.toggleModal(document.querySelector(".modal.endgame"),"hide"),n(".gameboard.initial"),n(".gameboard.player"),n(".gameboard.computer"),a(".gameboard.initial",g),document.querySelectorAll(".gameboard.computer .square").forEach((e=>{e.addEventListener("click",p)})),document.querySelector("#rotateBtn").addEventListener("click",m),document.querySelector("#newGame").addEventListener("click",(()=>{i=0,d=!0,u=!1,h=null,r.lastHitCoordinate=null,r.currentDirection=null,e.reset(),t.reset(),r.clearSet(),c(".gameboard.initial"),c(".gameboard.player"),c(".gameboard.computer"),document.querySelector(".ship-type").textContent=o.U.shipTypes[0].type,o.U.toggleModal(document.querySelector(".modal.endgame"),"hide"),o.U.toggleModal(document.querySelector(".modal.initial"),"show")}))}}})().init()},776:(e,t,r)=>{r.d(t,{Br:()=>a,_V:()=>n,oP:()=>l});var o=r(555);const n=e=>{let t=0;return{length:e,hit:()=>{t+=1},isSunk:()=>t>=e,get hits(){return t}}},a=()=>{const e=10,t=Array.from({length:e},(()=>Array(e).fill(null)));let r=[],o=[];const n=()=>{const r=[];for(let o=0;o<e;o+=1)for(let n=0;n<e;n+=1){const e=t[o][n];null===e||!e.ship||r.includes(e.ship)||e.ship.isSunk()||r.push(e.ship)}return r};return{getGrid:()=>t,placeShip:(r,o)=>{const n=o.every((([t,r])=>t>=0&&t<e&&r>=0&&r<e)),a=o.some((([e,r])=>null!==t[e][r])),l=o.some((([r,o])=>[[r-1,o],[r+1,o],[r,o-1],[r,o+1],[r-1,o-1],[r-1,o+1],[r+1,o-1],[r+1,o+1]].some((([r,o])=>r>=0&&r<e&&o>=0&&o<e&&null!==t[r]?.[o]))));if(n&&!a&&!l){const e={ship:r,coordinates:o};return e.coordinates.forEach((([r,o])=>{t[r][o]=e})),!0}return!1},getShips:n,getAllShips:()=>{const r=[];for(let o=0;o<e;o+=1)for(let n=0;n<e;n+=1){const e=t[o][n];null!==e&&e.ship&&!r.includes(e.ship)&&r.push(e.ship)}return r},getShipCoordinates:r=>{const o=[];for(let n=0;n<e;n+=1)for(let a=0;a<e;a+=1){const e=t[n][a];e&&e.ship===r&&o.push([n,a])}return o},receiveAttack:e=>{const[n,a]=e,l=parseInt(a,10),c=n.charCodeAt(0)-65,s=t[l][c];if(null!==s){const{ship:t}=s;return t.hit(),r.push(e),t}return o.push(e),r.push(e),null},getMissedAttacks:()=>o,getAttackedCoordinates:()=>r,allShipsSunk:()=>n().every((e=>e.isSunk())),reset:()=>{t.forEach(((e,r)=>{e.forEach(((e,o)=>{t[r][o]=null}))})),r=[],o=[]}}},l=(e,t,r)=>{const n=new Set,a=(e,t)=>{const[r,n]=e;let a=parseInt(n,10),l=r.charCodeAt(0)-65;switch(t){case"up":a-=1;break;case"down":a+=1;break;case"left":l-=1;break;case"right":l+=1}return o.r.convertToAlphanumeric([a,l])},l=()=>{const e=["up","down","left","right"];if(t){const r=e.indexOf(t);-1!==r&&(e.splice(r,1),e.push(t),console.log(t))}else for(let t=e.length-1;t>0;t-=1){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e};return{name:e,lastHitCoordinate:r,currentDirection:t,attack:(e,t,r)=>{const c=e.getGrid().length,s=o.r.getAllValidCoordinates(c);let i="";if(console.log(`${r} : ${t}`),t&&r){const o=l();for(const l of o)if(i=a(t,l),s.includes(i)&&!n.has(i)&&!e.getAttackedCoordinates().includes(i))return n.add(i),t=i,r=l,i}do{i=s[Math.floor(Math.random()*s.length)]}while(n.has(i)||e.getAttackedCoordinates().includes(i));return n.add(i),i},getAttackedSet:()=>n,clearSet:()=>{n.clear()}}}},555:(e,t,r)=>{r.d(t,{U:()=>n,r:()=>o});const o=(()=>{const e=[],t=([e,t])=>String.fromCharCode(t+65)+e;return{convertToIndices:e=>{const t=e.charCodeAt(0)-65;return[parseInt(e.slice(1),10),t]},convertToAlphanumeric:t,getAllValidCoordinates:r=>{for(let o=0;o<r;o+=1)for(let n=0;n<r;n+=1){const r=t([o,n]);e.push(r)}return e}}})(),n={shipTypes:[{type:"carrier",length:5},{type:"battleship",length:4},{type:"destroyer",length:3},{type:"submarine",length:3},{type:"patrol boat",length:2}],toggleModal:(e,t)=>{const r=e,o="show"===t?"flex":"none";e.closest(".overlay").style.display=o,r.style.display=o}}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r(380),r(776)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixFQVExQixFQTlCNkIsR0FnQ2pCWSxFQW1CSixDQUNMekYsVUFuQmdCLENBQ2hCLENBQUUwQixLQUFNLFVBQVczQixPQUFRLEdBQzNCLENBQUUyQixLQUFNLGFBQWMzQixPQUFRLEdBQzlCLENBQUUyQixLQUFNLFlBQWEzQixPQUFRLEdBQzdCLENBQUUyQixLQUFNLFlBQWEzQixPQUFRLEdBQzdCLENBQUUyQixLQUFNLGNBQWUzQixPQUFRLElBZS9CUCxZQVprQixDQUFDa0csRUFBT0MsS0FDMUIsTUFBTUMsRUFBZUYsRUFHZkcsRUFBMEIsU0FBWEYsRUFBb0IsT0FBUyxPQURsQ0QsRUFBTUksUUFBUSxZQUd0QkMsTUFBTUMsUUFBVUgsRUFDeEJELEVBQWFHLE1BQU1DLFFBQVVILENBQVksRSxHQy9DekNJLEVBQTJCLENBQUMsRUFHaEMsU0FBU0MsRUFBb0JDLEdBRTVCLElBQUlDLEVBQWVILEVBQXlCRSxHQUM1QyxRQUFxQkUsSUFBakJELEVBQ0gsT0FBT0EsRUFBYUUsUUFHckIsSUFBSUMsRUFBU04sRUFBeUJFLEdBQVksQ0FHakRHLFFBQVMsQ0FBQyxHQU9YLE9BSEFFLEVBQW9CTCxHQUFVSSxFQUFRQSxFQUFPRCxRQUFTSixHQUcvQ0ssRUFBT0QsT0FDZixDQ3JCQUosRUFBb0JPLEVBQUksQ0FBQ0gsRUFBU0ksS0FDakMsSUFBSSxJQUFJQyxLQUFPRCxFQUNYUixFQUFvQlUsRUFBRUYsRUFBWUMsS0FBU1QsRUFBb0JVLEVBQUVOLEVBQVNLLElBQzVFRSxPQUFPQyxlQUFlUixFQUFTSyxFQUFLLENBQUVJLFlBQVksRUFBTUMsSUFBS04sRUFBV0MsSUFFMUUsRUNORFQsRUFBb0JVLEVBQUksQ0FBQ0ssRUFBS0MsSUFBVUwsT0FBT00sVUFBVUMsZUFBZUMsS0FBS0osRUFBS0MsR0NFbEZoQixFQUFvQixLQUVNQSxFQUFvQixJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9yZW5kZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9hcHAuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9mYWN0b3JpZXMuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy91dGlscy5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2JhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL2JhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGYWN0b3J5SGVscGVycyB9IGZyb20gXCIuL3V0aWxzXCI7XG5cbmNvbnN0IFJlbmRlcmVyID0gKCgpID0+IHtcbiAgY29uc3QgcmVuZGVyR2FtZWJvYXJkID0gKGNvbnRhaW5lckVsZW1lbnQpID0+IHtcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lckVsZW1lbnQpO1xuXG4gICAgY29udGFpbmVyLnRleHRDb250ZW50ID0gXCJcIjtcblxuICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IDEwOyByb3cgKz0gMSkge1xuICAgICAgZm9yIChsZXQgY29sID0gMDsgY29sIDwgMTA7IGNvbCArPSAxKSB7XG4gICAgICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBGYWN0b3J5SGVscGVycy5jb252ZXJ0VG9BbHBoYW51bWVyaWMoW3JvdywgY29sXSk7XG4gICAgICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlXCIpO1xuICAgICAgICBzcXVhcmUuZGF0YXNldC5jb29yZGluYXRlID0gY29vcmRpbmF0ZTtcblxuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3QgYXR0YWNoRXZlbnRMaXN0ZW5lcnMgPSAoY29udGFpbmVyRWxlbWVudCwgZXZlbnRMaXN0ZW5lcnMpID0+IHtcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lckVsZW1lbnQpO1xuXG4gICAgY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3F1YXJlXCIpLmZvckVhY2goKHNxdWFyZSkgPT4ge1xuICAgICAgZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaCgobGlzdGVuZXIpID0+IHtcbiAgICAgICAgc3F1YXJlLmFkZEV2ZW50TGlzdGVuZXIobGlzdGVuZXIuZXZlbnRUeXBlLCBsaXN0ZW5lci5oYW5kbGVyKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IHNldFdpbm5lckhlYWRpbmcgPSAod2lubmVyKSA9PiB7XG4gICAgY29uc3Qgd2lubmVySGVhZGluZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjd2lubmVyXCIpO1xuICAgIHdpbm5lckhlYWRpbmcudGV4dENvbnRlbnQgPSBgJHt3aW5uZXJ9IHdvbiFgO1xuICB9O1xuXG4gIGNvbnN0IGNsZWFyR2FtZWJvYXJkID0gKGNvbnRhaW5lckVsZW1lbnQpID0+IHtcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lckVsZW1lbnQpO1xuICAgIGNvbnN0IHNxdWFyZXMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcIi5zcXVhcmVcIik7XG5cbiAgICBzcXVhcmVzLmZvckVhY2goKHNxdWFyZSkgPT4ge1xuICAgICAgY29uc3QgcmVzZXRTcXVhcmUgPSBzcXVhcmU7XG4gICAgICByZXNldFNxdWFyZS5jbGFzc05hbWUgPSBcInNxdWFyZVwiOyAvLyBSZXNldCB0aGUgY2xhc3NOYW1lIHRvIHJlbW92ZSBhbGwgY2xhc3Nlc1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgcmVuZGVyR2FtZWJvYXJkLFxuICAgIGF0dGFjaEV2ZW50TGlzdGVuZXJzLFxuICAgIHNldFdpbm5lckhlYWRpbmcsXG4gICAgY2xlYXJHYW1lYm9hcmQsXG4gIH07XG59KSgpO1xuXG5leHBvcnQgZGVmYXVsdCBSZW5kZXJlcjtcbiIsIi8qIGVzbGludC1kaXNhYmxlIG5vLXJlc3RyaWN0ZWQtc3ludGF4ICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1sb25lbHktaWYgKi9cbmltcG9ydCB7IEFwcEhlbHBlcnMsIEZhY3RvcnlIZWxwZXJzIH0gZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCBSZW5kZXJlciBmcm9tIFwiLi9yZW5kZXJcIjtcbmltcG9ydCB7IFNoaXBGYWN0b3J5LCBHYW1lYm9hcmRGYWN0b3J5LCBQbGF5ZXJGYWN0b3J5IH0gZnJvbSBcIi4vZmFjdG9yaWVzXCI7XG5cbi8vIDEuIC0tLVxuLy8gMi4gLS0tXG4vLyAzLiAtLS1cbi8vIDQuIFN0eWxlID0+IE1vZGFscyA9PiBNZWRpYSBxdWVyaWVzXG4vLyA1LiBQdXNoIHRvIGdoLXBhZ2VzIGFuZCBhZGQgcmVhZG1lXG5cbmNvbnN0IENvbnRyb2xsZXIgPSAoKCkgPT4ge1xuICBjb25zdCBwbGF5ZXJHYW1lYm9hcmQgPSBHYW1lYm9hcmRGYWN0b3J5KCk7XG4gIGNvbnN0IGNvbXB1dGVyR2FtZWJvYXJkID0gR2FtZWJvYXJkRmFjdG9yeSgpO1xuXG4gIGNvbnN0IGNvbXB1dGVyID0gUGxheWVyRmFjdG9yeShcImNvbXB1dGVyXCIpO1xuXG4gIGxldCBjdXJyZW50U2hpcEluZGV4ID0gMDtcbiAgbGV0IHNoaXBQbGFjZW1lbnRNb2RlID0gdHJ1ZTtcbiAgbGV0IGlzVmVydGljYWwgPSBmYWxzZTtcbiAgbGV0IHdpbm5lciA9IG51bGw7XG5cbiAgY29uc3QgcGxhY2VDb21wdXRlclNoaXBzID0gKCkgPT4ge1xuICAgIGZvciAoY29uc3Qgc2hpcFR5cGUgb2YgQXBwSGVscGVycy5zaGlwVHlwZXMpIHtcbiAgICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSBzaGlwVHlwZTtcbiAgICAgIGNvbnN0IHNoaXAgPSBTaGlwRmFjdG9yeShsZW5ndGgpO1xuXG4gICAgICBjb25zdCBncmlkU2l6ZSA9IDEwO1xuICAgICAgbGV0IGNvb3JkaW5hdGVzO1xuICAgICAgbGV0IHBsYWNlZCA9IGZhbHNlO1xuXG4gICAgICB3aGlsZSAoIXBsYWNlZCkge1xuICAgICAgICAvLyBHZW5lcmF0ZSByYW5kb20gc3RhcnRSb3cgYW5kIHN0YXJ0Q29sIHdpdGhpbiB0aGUgZ3JpZCBib3VuZGFyaWVzXG4gICAgICAgIGNvbnN0IHN0YXJ0Um93ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZ3JpZFNpemUpO1xuICAgICAgICBjb25zdCBzdGFydENvbCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGdyaWRTaXplKTtcblxuICAgICAgICAvLyBSYW5kb21seSBjaG9vc2Ugd2hldGhlciB0aGUgc2hpcCB3aWxsIGJlIHBsYWNlZCB2ZXJ0aWNhbGx5IG9yIGhvcml6b250YWxseVxuICAgICAgICBpc1ZlcnRpY2FsID0gTWF0aC5yYW5kb20oKSA8IDAuNTtcblxuICAgICAgICBpZiAoaXNWZXJ0aWNhbCAmJiBzdGFydFJvdyArIGxlbmd0aCA8PSBncmlkU2l6ZSkge1xuICAgICAgICAgIC8vIEdlbmVyYXRlIHRoZSBjb29yZGluYXRlcyBmb3IgYSB2ZXJ0aWNhbGx5IHBsYWNlZCBzaGlwXG4gICAgICAgICAgY29vcmRpbmF0ZXMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoIH0sIChfLCBpKSA9PiBbXG4gICAgICAgICAgICBzdGFydFJvdyArIGksXG4gICAgICAgICAgICBzdGFydENvbCxcbiAgICAgICAgICBdKTtcbiAgICAgICAgfSBlbHNlIGlmICghaXNWZXJ0aWNhbCAmJiBzdGFydENvbCArIGxlbmd0aCA8PSBncmlkU2l6ZSkge1xuICAgICAgICAgIC8vIEdlbmVyYXRlIHRoZSBjb29yZGluYXRlcyBmb3IgYSBob3Jpem9udGFsbHkgcGxhY2VkIHNoaXBcbiAgICAgICAgICBjb29yZGluYXRlcyA9IEFycmF5LmZyb20oeyBsZW5ndGggfSwgKF8sIGkpID0+IFtcbiAgICAgICAgICAgIHN0YXJ0Um93LFxuICAgICAgICAgICAgc3RhcnRDb2wgKyBpLFxuICAgICAgICAgIF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvb3JkaW5hdGVzKSB7XG4gICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHNoaXAgY2FuIGJlIHBsYWNlZCBhdCB0aGUgZ2VuZXJhdGVkIGNvb3JkaW5hdGVzXG4gICAgICAgICAgcGxhY2VkID0gY29tcHV0ZXJHYW1lYm9hcmQucGxhY2VTaGlwKHNoaXAsIGNvb3JkaW5hdGVzKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBHZXQgdGhlIHNoaXAgY29vcmRpbmF0ZXNcbiAgICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBjb21wdXRlckdhbWVib2FyZC5nZXRTaGlwQ29vcmRpbmF0ZXMoc2hpcCk7XG5cbiAgICAgIC8vIExvb3AgdGhyb3VnaCB0aGVtIGFuZCBhZGQgYSBwbGFjZWQgY2xhc3NcbiAgICAgIGZvciAoY29uc3QgW3JvdywgY29sXSBvZiBjb29yZGluYXRlKSB7XG4gICAgICAgIGNvbnN0IGNvbnZlcnRlZENvb3JkaW5hdGUgPSBGYWN0b3J5SGVscGVycy5jb252ZXJ0VG9BbHBoYW51bWVyaWMoW1xuICAgICAgICAgIHJvdyxcbiAgICAgICAgICBjb2wsXG4gICAgICAgIF0pO1xuICAgICAgICBjb25zdCBwbGFjZWRTcXVhcmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgIGAuZ2FtZWJvYXJkLmNvbXB1dGVyIFtkYXRhLWNvb3JkaW5hdGU9XCIke2NvbnZlcnRlZENvb3JkaW5hdGV9XCJdYFxuICAgICAgICApO1xuICAgICAgICBwbGFjZWRTcXVhcmUuY2xhc3NMaXN0LmFkZChcInBsYWNlZFwiKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgc2hpcFBsYWNlbWVudEhhbmRsZXIgPSAoZSkgPT4ge1xuICAgIGlmIChzaGlwUGxhY2VtZW50TW9kZSkge1xuICAgICAgY29uc3Qgc3F1YXJlID0gZS50YXJnZXQ7XG4gICAgICBjb25zdCB7IGNvb3JkaW5hdGUgfSA9IHNxdWFyZS5kYXRhc2V0O1xuICAgICAgY29uc3QgeyBsZW5ndGggfSA9IEFwcEhlbHBlcnMuc2hpcFR5cGVzW2N1cnJlbnRTaGlwSW5kZXhdO1xuXG4gICAgICBjb25zdCBbc3RhcnRSb3csIHN0YXJ0Q29sXSA9IEZhY3RvcnlIZWxwZXJzLmNvbnZlcnRUb0luZGljZXMoY29vcmRpbmF0ZSk7XG5cbiAgICAgIC8vIEdlbmVyYXRlIGFuIGFycmF5IG9mIHNoaXAgY29vcmRpbmF0ZXMgYmFzZWQgb24gdGhlIHNoaXAgbGVuZ3RoXG4gICAgICBjb25zdCBzaGlwQ29vcmRpbmF0ZXMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoIH0sIChfLCBpKSA9PiB7XG4gICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgcm93IGNvb3JkaW5hdGUgYmFzZWQgb24gdmVydGljYWwgb3IgaG9yaXpvbnRhbCBwbGFjZW1lbnRcbiAgICAgICAgY29uc3Qgcm93ID0gaXNWZXJ0aWNhbCA/IHN0YXJ0Um93ICsgaSA6IHN0YXJ0Um93O1xuICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIGNvbHVtbiBjb29yZGluYXRlIGJhc2VkIG9uIHZlcnRpY2FsIG9yIGhvcml6b250YWwgcGxhY2VtZW50XG4gICAgICAgIGNvbnN0IGNvbCA9IGlzVmVydGljYWwgPyBzdGFydENvbCA6IHN0YXJ0Q29sICsgaTtcbiAgICAgICAgcmV0dXJuIFtyb3csIGNvbF07IC8vIFJldHVybiB0aGUgY29vcmRpbmF0ZSBwYWlyXG4gICAgICB9KTtcblxuICAgICAgLy8gQXR0ZW1wdCB0byBwbGFjZSB0aGUgc2hpcCBvbiB0aGUgcGxheWVyIGdhbWVib2FyZFxuICAgICAgY29uc3Qgc2hpcCA9IFNoaXBGYWN0b3J5KGxlbmd0aCk7XG4gICAgICBjb25zdCBwbGFjZWQgPSBwbGF5ZXJHYW1lYm9hcmQucGxhY2VTaGlwKHNoaXAsIHNoaXBDb29yZGluYXRlcyk7XG5cbiAgICAgIGlmIChwbGFjZWQpIHtcbiAgICAgICAgLy8gSWYgc2hpcCBwbGFjZW1lbnQgaXMgc3VjY2Vzc2Z1bFxuICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInBsYWNlZFwiKTtcbiAgICAgICAgc2hpcENvb3JkaW5hdGVzLmZvckVhY2goKFtyb3csIGNvbF0pID0+IHtcbiAgICAgICAgICBjb25zdCBwbGFjZWRTcXVhcmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgYFtkYXRhLWNvb3JkaW5hdGU9XCIke0ZhY3RvcnlIZWxwZXJzLmNvbnZlcnRUb0FscGhhbnVtZXJpYyhbXG4gICAgICAgICAgICAgIHJvdyxcbiAgICAgICAgICAgICAgY29sLFxuICAgICAgICAgICAgXSl9XCJdYFxuICAgICAgICAgICk7XG4gICAgICAgICAgcGxhY2VkU3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJwbGFjZWRcIik7XG4gICAgICAgICAgY29uc3QgaW5pdGlhbFNxdWFyZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICBgLmdhbWVib2FyZC5pbml0aWFsIFtkYXRhLWNvb3JkaW5hdGU9XCIke0ZhY3RvcnlIZWxwZXJzLmNvbnZlcnRUb0FscGhhbnVtZXJpYyhcbiAgICAgICAgICAgICAgW3JvdywgY29sXVxuICAgICAgICAgICAgKX1cIl1gXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpbml0aWFsU3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJwbGFjZWRcIik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGN1cnJlbnRTaGlwSW5kZXggKz0gMTsgLy8gSW5jcmVtZW50IHRoZSBjdXJyZW50U2hpcEluZGV4IHRvIG1vdmUgdG8gdGhlIG5leHQgc2hpcFxuXG4gICAgICAgIGlmIChjdXJyZW50U2hpcEluZGV4ID09PSBBcHBIZWxwZXJzLnNoaXBUeXBlcy5sZW5ndGgpIHtcbiAgICAgICAgICAvLyBJZiBhbGwgc2hpcHMgaGF2ZSBiZWVuIHBsYWNlZFxuICAgICAgICAgIHNoaXBQbGFjZW1lbnRNb2RlID0gZmFsc2U7IC8vIERpc2FibGUgc2hpcCBwbGFjZW1lbnQgbW9kZVxuICAgICAgICAgIHBsYWNlQ29tcHV0ZXJTaGlwcygpOyAvLyBQbGFjZSB0aGUgY29tcHV0ZXIncyBzaGlwc1xuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgLy8gU2V0IGEgdGltZW91dCB0byBkZWxheSBoaWRpbmcgdGhlIGluaXRpYWwgc2hpcCBwbGFjZW1lbnQgbW9kYWxcbiAgICAgICAgICAgIEFwcEhlbHBlcnMudG9nZ2xlTW9kYWwoXG4gICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwuaW5pdGlhbFwiKSxcbiAgICAgICAgICAgICAgXCJoaWRlXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBJZiB0aGVyZSBhcmUgc3RpbGwgc2hpcHMgdG8gYmUgcGxhY2VkXG4gICAgICAgICAgLy8gR2V0IHRoZSB0eXBlIG9mIHRoZSBuZXh0IHNoaXAgYmFzZWQgb24gdGhlIGN1cnJlbnRTaGlwSW5kZXhcbiAgICAgICAgICBjb25zdCBuZXh0U2hpcFR5cGUgPSBBcHBIZWxwZXJzLnNoaXBUeXBlc1tjdXJyZW50U2hpcEluZGV4XS50eXBlO1xuICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgc2hpcCB0eXBlIHRleHQgb24gdGhlIFVJXG4gICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zaGlwLXR5cGVcIikudGV4dENvbnRlbnQgPSBuZXh0U2hpcFR5cGU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3QgZ2FtZWJvYXJkSG92ZXJIYW5kbGVyID0gKGUpID0+IHtcbiAgICBpZiAoc2hpcFBsYWNlbWVudE1vZGUpIHtcbiAgICAgIC8vIENoZWNrIGlmIHNoaXAgcGxhY2VtZW50IG1vZGUgaXMgYWN0aXZlXG4gICAgICBjb25zdCBzcXVhcmUgPSBlLnRhcmdldDtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItZGVzdHJ1Y3R1cmluZ1xuICAgICAgY29uc3QgY29vcmRpbmF0ZSA9IHNxdWFyZS5kYXRhc2V0LmNvb3JkaW5hdGU7XG4gICAgICBjb25zdCB7IGxlbmd0aCB9ID0gQXBwSGVscGVycy5zaGlwVHlwZXNbY3VycmVudFNoaXBJbmRleF07IC8vIEdldCB0aGUgbGVuZ3RoIG9mIHRoZSBzaGlwXG5cbiAgICAgIGNvbnN0IFtzdGFydFJvdywgc3RhcnRDb2xdID0gRmFjdG9yeUhlbHBlcnMuY29udmVydFRvSW5kaWNlcyhjb29yZGluYXRlKTtcbiAgICAgIC8vIEdlbmVyYXRlIGFuIGFycmF5IG9mIGhvdmVyZWQgc3F1YXJlcyBiYXNlZCBvbiB0aGUgc2hpcCBsZW5ndGhcbiAgICAgIGNvbnN0IGhvdmVyZWRTcXVhcmVzID0gQXJyYXkuZnJvbSh7IGxlbmd0aCB9LCAoXywgaSkgPT4ge1xuICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHJvdyBjb29yZGluYXRlIGJhc2VkIG9uIHZlcnRpY2FsIG9yIGhvcml6b250YWwgcGxhY2VtZW50XG4gICAgICAgIGNvbnN0IHJvdyA9IGlzVmVydGljYWwgPyBzdGFydFJvdyArIGkgOiBzdGFydFJvdztcbiAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSBjb2x1bW4gY29vcmRpbmF0ZSBiYXNlZCBvbiB2ZXJ0aWNhbCBvciBob3Jpem9udGFsIHBsYWNlbWVudFxuICAgICAgICBjb25zdCBjb2wgPSBpc1ZlcnRpY2FsID8gc3RhcnRDb2wgOiBzdGFydENvbCArIGk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaW5pdGlhbFNxdWFyZTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgIGAuZ2FtZWJvYXJkLmluaXRpYWwgW2RhdGEtY29vcmRpbmF0ZT1cIiR7RmFjdG9yeUhlbHBlcnMuY29udmVydFRvQWxwaGFudW1lcmljKFxuICAgICAgICAgICAgICBbcm93LCBjb2xdXG4gICAgICAgICAgICApfVwiXWBcbiAgICAgICAgICApLFxuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgIGhvdmVyZWRTcXVhcmVzLmZvckVhY2goKHsgaW5pdGlhbFNxdWFyZSB9KSA9PiB7XG4gICAgICAgIC8vIEl0ZXJhdGUgb3ZlciB0aGUgaG92ZXJlZCBzcXVhcmVzXG4gICAgICAgIGlmIChpbml0aWFsU3F1YXJlKSB7XG4gICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGluaXRpYWwgc3F1YXJlIGV4aXN0c1xuICAgICAgICAgIGluaXRpYWxTcXVhcmUuY2xhc3NMaXN0LmFkZChcImhvdmVyZWRcIik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBnYW1lYm9hcmRNb3VzZUxlYXZlSGFuZGxlciA9ICgpID0+IHtcbiAgICBjb25zdCBob3ZlcmVkU3F1YXJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZ2FtZWJvYXJkIC5ob3ZlcmVkXCIpO1xuICAgIGhvdmVyZWRTcXVhcmVzLmZvckVhY2goKGhvdmVyZWRTcXVhcmUpID0+IHtcbiAgICAgIGhvdmVyZWRTcXVhcmUuY2xhc3NMaXN0LnJlbW92ZShcImhvdmVyZWRcIik7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgY29tcHV0ZXJBdHRhY2sgPSAoKSA9PiB7XG4gICAgaWYgKCFzaGlwUGxhY2VtZW50TW9kZSkge1xuICAgICAgY29uc3QgY29vcmRpbmF0ZSA9IGNvbXB1dGVyLmF0dGFjayhcbiAgICAgICAgcGxheWVyR2FtZWJvYXJkLFxuICAgICAgICBjb21wdXRlci5sYXN0SGl0Q29vcmRpbmF0ZSxcbiAgICAgICAgY29tcHV0ZXIuY3VycmVudERpcmVjdGlvblxuICAgICAgKTtcbiAgICAgIC8vIFJlY2VpdmUgdGhlIGF0dGFjayBvbiB0aGUgcGxheWVyJ3MgZ2FtZWJvYXJkIGFuZCBnZXQgdGhlIGF0dGFja2VkIHNoaXAgKGlmIGFueSlcbiAgICAgIGNvbnN0IGF0dGFja2VkU2hpcCA9IHBsYXllckdhbWVib2FyZC5yZWNlaXZlQXR0YWNrKGNvb3JkaW5hdGUpO1xuXG4gICAgICBjb25zdCBzcXVhcmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICBgLmdhbWVib2FyZC5wbGF5ZXIgW2RhdGEtY29vcmRpbmF0ZT1cIiR7Y29vcmRpbmF0ZX1cIl1gXG4gICAgICApOyAvLyBHZXQgdGhlIGNvcnJlc3BvbmRpbmcgc3F1YXJlIGVsZW1lbnQgb24gdGhlIHBsYXllcidzIGdhbWVib2FyZFxuXG4gICAgICBpZiAoYXR0YWNrZWRTaGlwKSB7XG4gICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwiaGl0XCIpO1xuICAgICAgICAvLyBJZiB0aGVyZSB3YXMgYSBoaXQsIHVwZGF0ZSB0aGUgbGFzdEhpdENvb3JkaW5hdGUgYW5kIGN1cnJlbnREaXJlY3Rpb25cbiAgICAgICAgY29tcHV0ZXIubGFzdEhpdENvb3JkaW5hdGUgPSBjb29yZGluYXRlO1xuICAgICAgICAvLyBUbyBrZWVwIHRoZSBjb21wdXRlcidzIGF0dGFjayBjb25zaXN0ZW50LCBzZXQgdGhlIGN1cnJlbnREaXJlY3Rpb24gaW5pdGlhbGx5IHRvIFwidXBcIlxuICAgICAgICBpZiAoY29tcHV0ZXIuY3VycmVudERpcmVjdGlvbiA9PT0gbnVsbCkge1xuICAgICAgICAgIGNvbXB1dGVyLmN1cnJlbnREaXJlY3Rpb24gPSBcInVwXCI7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoIWF0dGFja2VkU2hpcCAmJiBjb21wdXRlci5sYXN0SGl0Q29vcmRpbmF0ZSkge1xuICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcIm1pc3NcIik7XG4gICAgICB9IGVsc2UgaWYgKCFhdHRhY2tlZFNoaXAgJiYgIWNvbXB1dGVyLmxhc3RIaXRDb29yZGluYXRlKSB7XG4gICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwibWlzc1wiKTtcbiAgICAgICAgLy8gSWYgdGhlcmUgd2FzIGEgbWlzcywgcmVzZXQgdGhlIGxhc3RIaXRDb29yZGluYXRlIGFuZCBjdXJyZW50RGlyZWN0aW9uXG4gICAgICAgIGNvbXB1dGVyLmxhc3RIaXRDb29yZGluYXRlID0gbnVsbDtcbiAgICAgICAgY29tcHV0ZXIuY3VycmVudERpcmVjdGlvbiA9IG51bGw7XG4gICAgICB9XG4gICAgICBpZiAocGxheWVyR2FtZWJvYXJkLmFsbFNoaXBzU3VuaygpKSB7XG4gICAgICAgIHdpbm5lciA9IFwiVGhlIGNvbXB1dGVyXCI7XG4gICAgICAgIFJlbmRlcmVyLnNldFdpbm5lckhlYWRpbmcod2lubmVyKTtcbiAgICAgICAgQXBwSGVscGVycy50b2dnbGVNb2RhbChcbiAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsLmVuZGdhbWVcIiksXG4gICAgICAgICAgXCJzaG93XCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3QgcGxheWVyQXR0YWNrID0gKGUpID0+IHtcbiAgICBpZiAoIXNoaXBQbGFjZW1lbnRNb2RlKSB7XG4gICAgICBjb25zdCBzcXVhcmUgPSBlLnRhcmdldDsgLy8gR2V0IHRoZSBjbGlja2VkIHNxdWFyZSBlbGVtZW50XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWRlc3RydWN0dXJpbmdcbiAgICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBzcXVhcmUuZGF0YXNldC5jb29yZGluYXRlO1xuICAgICAgLy8gQ29udmVydCB0aGUgcm93IGFuZCBjb2x1bW4gaW5kaWNlcyB0byBhbiBhbHBoYW51bWVyaWMgY29vcmRpbmF0ZVxuXG4gICAgICAvLyBDaGVjayBpZiB0aGUgY29vcmRpbmF0ZSBoYXMgbm90IGJlZW4gcHJldmlvdXNseSBhdHRhY2tlZFxuICAgICAgaWYgKCFjb21wdXRlckdhbWVib2FyZC5nZXRBdHRhY2tlZENvb3JkaW5hdGVzKCkuaW5jbHVkZXMoY29vcmRpbmF0ZSkpIHtcbiAgICAgICAgLy8gUmVjZWl2ZSB0aGUgYXR0YWNrIG9uIHRoZSBjb21wdXRlcidzIGdhbWVib2FyZCBhbmQgZ2V0IHRoZSBhdHRhY2tlZCBzaGlwIChpZiBhbnkpXG4gICAgICAgIGNvbnN0IGF0dGFja2VkU2hpcCA9IGNvbXB1dGVyR2FtZWJvYXJkLnJlY2VpdmVBdHRhY2soY29vcmRpbmF0ZSk7XG5cbiAgICAgICAgaWYgKGF0dGFja2VkU2hpcCkge1xuICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwiaGl0XCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwibWlzc1wiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjb21wdXRlckdhbWVib2FyZC5hbGxTaGlwc1N1bmsoKSkge1xuICAgICAgICAgIHdpbm5lciA9IFwiWW91XCI7XG4gICAgICAgICAgUmVuZGVyZXIuc2V0V2lubmVySGVhZGluZyh3aW5uZXIpO1xuICAgICAgICAgIEFwcEhlbHBlcnMudG9nZ2xlTW9kYWwoXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsLmVuZGdhbWVcIiksXG4gICAgICAgICAgICBcInNob3dcIlxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBjb21wdXRlckF0dGFjaygpOyAvLyBQZXJmb3JtIHRoZSBjb21wdXRlcidzIGF0dGFja1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBjb25zdCByb3RhdGVTaGlwcyA9ICgpID0+IHtcbiAgICBpc1ZlcnRpY2FsID0gIWlzVmVydGljYWw7XG4gIH07XG5cbiAgY29uc3QgZXZlbnRMaXN0ZW5lcnMgPSBbXG4gICAgeyBldmVudFR5cGU6IFwibW91c2VvdmVyXCIsIGhhbmRsZXI6IGdhbWVib2FyZEhvdmVySGFuZGxlciB9LFxuICAgIHsgZXZlbnRUeXBlOiBcIm1vdXNlbGVhdmVcIiwgaGFuZGxlcjogZ2FtZWJvYXJkTW91c2VMZWF2ZUhhbmRsZXIgfSxcbiAgICB7IGV2ZW50VHlwZTogXCJjbGlja1wiLCBoYW5kbGVyOiBzaGlwUGxhY2VtZW50SGFuZGxlciB9LFxuICBdO1xuXG4gIGNvbnN0IHJlc2V0R2FtZSA9ICgpID0+IHtcbiAgICAvLyBSZXNldCBnYW1lLXJlbGF0ZWQgdmFyaWFibGVzXG4gICAgY3VycmVudFNoaXBJbmRleCA9IDA7XG4gICAgc2hpcFBsYWNlbWVudE1vZGUgPSB0cnVlO1xuICAgIGlzVmVydGljYWwgPSBmYWxzZTtcbiAgICB3aW5uZXIgPSBudWxsO1xuICAgIGNvbXB1dGVyLmxhc3RIaXRDb29yZGluYXRlID0gbnVsbDtcbiAgICBjb21wdXRlci5jdXJyZW50RGlyZWN0aW9uID0gbnVsbDtcblxuICAgIC8vIFJlc2V0IGdhbWVib2FyZCBvYmplY3RzXG4gICAgcGxheWVyR2FtZWJvYXJkLnJlc2V0KCk7XG4gICAgY29tcHV0ZXJHYW1lYm9hcmQucmVzZXQoKTtcblxuICAgIC8vIENsZWFyIGNvbXB1dGVycyBhdHRhY2tlZENvb3JkaW5hdGVzIHNldFxuICAgIGNvbXB1dGVyLmNsZWFyU2V0KCk7XG5cbiAgICAvLyBSZW1vdmUgaGl0IGFuZCBtaXNzIGNsYXNzZXMgZnJvbSBhbGwgc3F1YXJlc1xuICAgIFJlbmRlcmVyLmNsZWFyR2FtZWJvYXJkKFwiLmdhbWVib2FyZC5pbml0aWFsXCIpO1xuICAgIFJlbmRlcmVyLmNsZWFyR2FtZWJvYXJkKFwiLmdhbWVib2FyZC5wbGF5ZXJcIik7XG4gICAgUmVuZGVyZXIuY2xlYXJHYW1lYm9hcmQoXCIuZ2FtZWJvYXJkLmNvbXB1dGVyXCIpO1xuXG4gICAgLy8gUmVzZXQgc2hpcFR5cGVzXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zaGlwLXR5cGVcIikudGV4dENvbnRlbnQgPVxuICAgICAgQXBwSGVscGVycy5zaGlwVHlwZXNbMF0udHlwZTtcbiAgfTtcblxuICBjb25zdCBpbml0ID0gKCkgPT4ge1xuICAgIEFwcEhlbHBlcnMudG9nZ2xlTW9kYWwoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbC5lbmRnYW1lXCIpLCBcImhpZGVcIik7XG4gICAgUmVuZGVyZXIucmVuZGVyR2FtZWJvYXJkKFwiLmdhbWVib2FyZC5pbml0aWFsXCIpO1xuICAgIFJlbmRlcmVyLnJlbmRlckdhbWVib2FyZChcIi5nYW1lYm9hcmQucGxheWVyXCIpO1xuICAgIFJlbmRlcmVyLnJlbmRlckdhbWVib2FyZChcIi5nYW1lYm9hcmQuY29tcHV0ZXJcIik7XG4gICAgUmVuZGVyZXIuYXR0YWNoRXZlbnRMaXN0ZW5lcnMoXCIuZ2FtZWJvYXJkLmluaXRpYWxcIiwgZXZlbnRMaXN0ZW5lcnMpO1xuXG4gICAgY29uc3QgY29tcHV0ZXJTcXVhcmVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcbiAgICAgIFwiLmdhbWVib2FyZC5jb21wdXRlciAuc3F1YXJlXCJcbiAgICApO1xuICAgIGNvbXB1dGVyU3F1YXJlcy5mb3JFYWNoKChzcXVhcmUpID0+IHtcbiAgICAgIHNxdWFyZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgcGxheWVyQXR0YWNrKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHJvdGF0ZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcm90YXRlQnRuXCIpO1xuICAgIHJvdGF0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgcm90YXRlU2hpcHMpO1xuXG4gICAgY29uc3QgcGxheUFnYWluQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXdHYW1lXCIpO1xuICAgIHBsYXlBZ2FpbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgcmVzZXRHYW1lKCk7XG4gICAgICBBcHBIZWxwZXJzLnRvZ2dsZU1vZGFsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWwuZW5kZ2FtZVwiKSwgXCJoaWRlXCIpO1xuICAgICAgQXBwSGVscGVycy50b2dnbGVNb2RhbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsLmluaXRpYWxcIiksIFwic2hvd1wiKTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXQsXG4gIH07XG59KSgpO1xuXG5Db250cm9sbGVyLmluaXQoKTtcbiIsIi8qIGVzbGludC1kaXNhYmxlIG5vLXBhcmFtLXJlYXNzaWduICovXG5pbXBvcnQgeyBGYWN0b3J5SGVscGVycyB9IGZyb20gXCIuL3V0aWxzXCI7XG5cbmV4cG9ydCBjb25zdCBTaGlwRmFjdG9yeSA9IChsZW5ndGgpID0+IHtcbiAgbGV0IGhpdHMgPSAwO1xuXG4gIGNvbnN0IGhpdCA9ICgpID0+IHtcbiAgICBoaXRzICs9IDE7XG4gIH07XG5cbiAgY29uc3QgaXNTdW5rID0gKCkgPT4gaGl0cyA+PSBsZW5ndGg7IC8vIFJldHVybiB0cnVlIGlmIGhpdHMgaXMgZXF1YWwgdG8gb3IgZ3JlYXRlciB0aGFuIGxlbmd0aFxuXG4gIHJldHVybiB7XG4gICAgbGVuZ3RoLFxuICAgIGhpdCxcbiAgICBpc1N1bmssXG4gICAgZ2V0IGhpdHMoKSB7XG4gICAgICAvLyBHZXR0ZXIgZnVuY3Rpb24gZm9yIGhpdHMuIFVzaW5nIGZ1bmN0aW9uIGRlY2xhcmF0aW9uIHRvIGVuc3VyZSBpdCBoYXMgYWNjZXNzIHRvIHRoZVxuICAgICAgLy8gYGhpdHNgIHZhcmlhYmxlIGR5bmFtaWNhbGx5LCBzaW5jZSBmdW5jdGlvbiBkZWNsYXJhdGlvbnMgYXJlIGhvaXN0ZWQgYW5kIGNhbiBiZSB1c2VkXG4gICAgICAvLyBiZWZvcmUgdGhleSBhcmUgZGVmaW5lZC4gVGhpcyBhbGxvd3MgYWNjZXNzaW5nIHRoZSBjdXJyZW50IHZhbHVlIG9mIGBoaXRzYCBldmVuIGJlZm9yZVxuICAgICAgLy8gY2FsbGluZyB0aGUgYGhpdGAgZnVuY3Rpb25cbiAgICAgIHJldHVybiBoaXRzO1xuICAgIH0sXG4gIH07XG59O1xuXG5leHBvcnQgY29uc3QgR2FtZWJvYXJkRmFjdG9yeSA9ICgpID0+IHtcbiAgY29uc3QgZ3JpZFNpemUgPSAxMDtcbiAgY29uc3QgZ3JpZCA9IEFycmF5LmZyb20oeyBsZW5ndGg6IGdyaWRTaXplIH0sICgpID0+XG4gICAgQXJyYXkoZ3JpZFNpemUpLmZpbGwobnVsbClcbiAgKTtcblxuICBsZXQgYXR0YWNrZWRDb29yZGluYXRlcyA9IFtdO1xuICBsZXQgbWlzc2VkQXR0YWNrcyA9IFtdO1xuXG4gIGNvbnN0IGdldEdyaWQgPSAoKSA9PiBncmlkO1xuXG4gIGNvbnN0IHBsYWNlU2hpcCA9IChzaGlwLCBjb29yZGluYXRlcykgPT4ge1xuICAgIC8vIENoZWNrIGlmIGFsbCBjb29yZGluYXRlcyBhcmUgd2l0aGluIHRoZSBib3VuZGFyaWVzIG9mIHRoZSBncmlkXG4gICAgY29uc3Qgd2l0aGluQm91bmRhcmllcyA9IGNvb3JkaW5hdGVzLmV2ZXJ5KFxuICAgICAgKFtyb3csIGNvbF0pID0+IHJvdyA+PSAwICYmIHJvdyA8IGdyaWRTaXplICYmIGNvbCA+PSAwICYmIGNvbCA8IGdyaWRTaXplXG4gICAgKTtcblxuICAgIC8vIENoZWNrIGlmIHRoZXJlIGFyZSBhbnkgY29uZmxpY3RzIHdpdGggZXhpc3Rpbmcgc2hpcCBwbGFjZW1lbnRzIG9uIHRoZSBncmlkXG4gICAgY29uc3QgY29uZmxpY3RzID0gY29vcmRpbmF0ZXMuc29tZSgoW3JvdywgY29sXSkgPT4gZ3JpZFtyb3ddW2NvbF0gIT09IG51bGwpO1xuXG4gICAgLy8gQ2hlY2sgaWYgdGhlcmUgYXJlIGFueSBhZGphY2VudCBjb25mbGljdHMgd2l0aCBleGlzdGluZyBzaGlwIHBsYWNlbWVudHMgb24gdGhlIGdyaWRcbiAgICBjb25zdCBhZGphY2VudENvbmZsaWN0cyA9IGNvb3JkaW5hdGVzLnNvbWUoKFtyb3csIGNvbF0pID0+IHtcbiAgICAgIC8vIERlZmluZSB0aGUgYWRqYWNlbnQgY29vcmRpbmF0ZXMgYXJvdW5kIHRoZSBjdXJyZW50IGNvb3JkaW5hdGVcbiAgICAgIGNvbnN0IGFkamFjZW50Q29vcmRpbmF0ZXMgPSBbXG4gICAgICAgIFtyb3cgLSAxLCBjb2xdLCAvLyBVcFxuICAgICAgICBbcm93ICsgMSwgY29sXSwgLy8gRG93blxuICAgICAgICBbcm93LCBjb2wgLSAxXSwgLy8gTGVmdFxuICAgICAgICBbcm93LCBjb2wgKyAxXSwgLy8gUmlnaHRcbiAgICAgICAgW3JvdyAtIDEsIGNvbCAtIDFdLCAvLyBEaWFnb25hbCBVcC1MZWZ0XG4gICAgICAgIFtyb3cgLSAxLCBjb2wgKyAxXSwgLy8gRGlhZ29uYWwgVXAtUmlnaHRcbiAgICAgICAgW3JvdyArIDEsIGNvbCAtIDFdLCAvLyBEaWFnb25hbCBEb3duLUxlZnRcbiAgICAgICAgW3JvdyArIDEsIGNvbCArIDFdLCAvLyBEaWFnb25hbCBEb3duLVJpZ2h0XG4gICAgICBdO1xuXG4gICAgICAvLyBDaGVjayBpZiBhbnkgYWRqYWNlbnQgY29vcmRpbmF0ZSBoYXMgYSBzaGlwIHBsYWNlZCBvbiBpdFxuICAgICAgcmV0dXJuIGFkamFjZW50Q29vcmRpbmF0ZXMuc29tZShcbiAgICAgICAgKFthZGpSb3csIGFkakNvbF0pID0+XG4gICAgICAgICAgYWRqUm93ID49IDAgJiZcbiAgICAgICAgICBhZGpSb3cgPCBncmlkU2l6ZSAmJlxuICAgICAgICAgIGFkakNvbCA+PSAwICYmXG4gICAgICAgICAgYWRqQ29sIDwgZ3JpZFNpemUgJiZcbiAgICAgICAgICBncmlkW2FkalJvd10/LlthZGpDb2xdICE9PSBudWxsXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgLy8gSWYgdGhlIHNoaXAgcGxhY2VtZW50IGlzIHdpdGhpbiBncmlkIGJvdW5kYXJpZXMsIGhhcyBubyBjb25mbGljdHMsIGFuZCBubyBhZGphY2VudCBjb25mbGljdHMuLi5cbiAgICBpZiAod2l0aGluQm91bmRhcmllcyAmJiAhY29uZmxpY3RzICYmICFhZGphY2VudENvbmZsaWN0cykge1xuICAgICAgLy8gQ3JlYXRlIGFuIG9iamVjdCBjb250YWluaW5nIHNoaXAgaW5mb3JtYXRpb24gYW5kIGNvb3JkaW5hdGVzXG4gICAgICBjb25zdCBzaGlwSW5mbyA9IHtcbiAgICAgICAgc2hpcCxcbiAgICAgICAgY29vcmRpbmF0ZXMsXG4gICAgICB9O1xuXG4gICAgICAvLyBQbGFjZSB0aGUgc2hpcCBvbiB0aGUgZ3JpZCBieSB1cGRhdGluZyB0aGUgY29ycmVzcG9uZGluZyBjZWxsc1xuICAgICAgc2hpcEluZm8uY29vcmRpbmF0ZXMuZm9yRWFjaCgoW3JvdywgY29sXSkgPT4ge1xuICAgICAgICBncmlkW3Jvd11bY29sXSA9IHNoaXBJbmZvO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB0cnVlOyAvLyBTaGlwIHBsYWNlbWVudCBzdWNjZXNzZnVsXG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlOyAvLyBPdGhlcndpc2UsIHNoaXAgcGxhY2VtZW50IGZhaWxlZFxuICB9O1xuXG4gIGNvbnN0IGdldFNoaXBzID0gKCkgPT4ge1xuICAgIGNvbnN0IHNoaXBzID0gW107XG5cbiAgICAvLyBJdGVyYXRlIHRocm91Z2ggZWFjaCBjZWxsIG9mIHRoZSBncmlkXG4gICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgZ3JpZFNpemU7IHJvdyArPSAxKSB7XG4gICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCBncmlkU2l6ZTsgY29sICs9IDEpIHtcbiAgICAgICAgY29uc3QgY2VsbCA9IGdyaWRbcm93XVtjb2xdO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgY2VsbCBjb250YWlucyBhIHNoaXAgYW5kIGl0J3Mgbm90IGFscmVhZHkgaW5jbHVkZWQgaW4gdGhlIHNoaXBzIGFycmF5XG4gICAgICAgIGlmIChcbiAgICAgICAgICBjZWxsICE9PSBudWxsICYmXG4gICAgICAgICAgY2VsbC5zaGlwICYmXG4gICAgICAgICAgIXNoaXBzLmluY2x1ZGVzKGNlbGwuc2hpcCkgJiZcbiAgICAgICAgICAhY2VsbC5zaGlwLmlzU3VuaygpXG4gICAgICAgICkge1xuICAgICAgICAgIC8vIEFkZCB0aGUgc2hpcCB0byB0aGUgc2hpcHMgYXJyYXlcbiAgICAgICAgICBzaGlwcy5wdXNoKGNlbGwuc2hpcCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc2hpcHM7XG4gIH07XG5cbiAgY29uc3QgZ2V0QWxsU2hpcHMgPSAoKSA9PiB7XG4gICAgY29uc3Qgc2hpcHMgPSBbXTtcblxuICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBlYWNoIGNlbGwgb2YgdGhlIGdyaWRcbiAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCBncmlkU2l6ZTsgcm93ICs9IDEpIHtcbiAgICAgIGZvciAobGV0IGNvbCA9IDA7IGNvbCA8IGdyaWRTaXplOyBjb2wgKz0gMSkge1xuICAgICAgICBjb25zdCBjZWxsID0gZ3JpZFtyb3ddW2NvbF07XG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBjZWxsIGNvbnRhaW5zIGEgc2hpcCBhbmQgaXQncyBub3QgYWxyZWFkeSBpbmNsdWRlZCBpbiB0aGUgc2hpcHMgYXJyYXlcbiAgICAgICAgaWYgKGNlbGwgIT09IG51bGwgJiYgY2VsbC5zaGlwICYmICFzaGlwcy5pbmNsdWRlcyhjZWxsLnNoaXApKSB7XG4gICAgICAgICAgLy8gQWRkIHRoZSBzaGlwIHRvIHRoZSBzaGlwcyBhcnJheVxuICAgICAgICAgIHNoaXBzLnB1c2goY2VsbC5zaGlwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzaGlwcztcbiAgfTtcblxuICBjb25zdCBnZXRTaGlwQ29vcmRpbmF0ZXMgPSAoc2hpcCkgPT4ge1xuICAgIGNvbnN0IGNvb3JkaW5hdGVzID0gW107XG5cbiAgICAvLyBJdGVyYXRlIHRocm91Z2ggZWFjaCBjZWxsIG9mIHRoZSBncmlkXG4gICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgZ3JpZFNpemU7IHJvdyArPSAxKSB7XG4gICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCBncmlkU2l6ZTsgY29sICs9IDEpIHtcbiAgICAgICAgY29uc3QgY2VsbCA9IGdyaWRbcm93XVtjb2xdO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgY2VsbCBleGlzdHMgYW5kIGNvbnRhaW5zIHRoZSBzcGVjaWZpZWQgc2hpcFxuICAgICAgICBpZiAoY2VsbCAmJiBjZWxsLnNoaXAgPT09IHNoaXApIHtcbiAgICAgICAgICAvLyBBZGQgdG8gY29vcmRpbmF0ZXMgYXJyYXlcbiAgICAgICAgICBjb29yZGluYXRlcy5wdXNoKFtyb3csIGNvbF0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvb3JkaW5hdGVzO1xuICB9O1xuXG4gIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoY29vcmRpbmF0ZSkgPT4ge1xuICAgIGNvbnN0IFtjb2x1bW5MZXR0ZXIsIHJvd051bWJlcl0gPSBjb29yZGluYXRlO1xuICAgIGNvbnN0IHJvdyA9IHBhcnNlSW50KHJvd051bWJlciwgMTApO1xuICAgIGNvbnN0IGNvbCA9IGNvbHVtbkxldHRlci5jaGFyQ29kZUF0KDApIC0gNjU7XG4gICAgY29uc3QgY2VsbCA9IGdyaWRbcm93XVtjb2xdO1xuXG4gICAgaWYgKGNlbGwgIT09IG51bGwpIHtcbiAgICAgIC8vIFNoaXAgYXQgY29vcmRpbmF0ZSwgaXQncyBhIGhpdFxuICAgICAgY29uc3QgeyBzaGlwIH0gPSBjZWxsO1xuICAgICAgc2hpcC5oaXQoKTsgLy8gSW5jcmVtZW50IGhpdCBjb3VudCBvZiB0aGUgc2hpcFxuICAgICAgYXR0YWNrZWRDb29yZGluYXRlcy5wdXNoKGNvb3JkaW5hdGUpO1xuICAgICAgcmV0dXJuIHNoaXA7IC8vIFJldHVybiB0aGUgc2hpcCBvYmplY3Qgd2hlbiBpdCBpcyBoaXRcbiAgICB9XG4gICAgLy8gTm8gc2hpcCBhdCBjb29yZGluYXRlLCBpdCdzIGEgbWlzc1xuICAgIG1pc3NlZEF0dGFja3MucHVzaChjb29yZGluYXRlKTtcbiAgICBhdHRhY2tlZENvb3JkaW5hdGVzLnB1c2goY29vcmRpbmF0ZSk7XG4gICAgcmV0dXJuIG51bGw7IC8vIFJldHVybiBudWxsIHdoZW4gaXQncyBhIG1pc3NcbiAgfTtcblxuICBjb25zdCBhbGxTaGlwc1N1bmsgPSAoKSA9PiB7XG4gICAgY29uc3Qgc2hpcHMgPSBnZXRTaGlwcygpOyAvLyBSZXRyaWV2ZSBhbGwgdGhlIHNoaXBzIG9uIHRoZSBnYW1lYm9hcmRcblxuICAgIC8vIENoZWNrIGlmIGFsbCBzaGlwcyBhcmUgc3VuaywgcmV0dXJuIHRydWUgaWYgeWVzLCBhbmQgcmV0dXJuIGZhbHNlIGlmIG5vXG4gICAgY29uc3QgcmVzdWx0ID0gc2hpcHMuZXZlcnkoKHNoaXApID0+IHNoaXAuaXNTdW5rKCkpO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBjb25zdCByZXNldCA9ICgpID0+IHtcbiAgICAvLyBDbGVhciB0aGUgZ3JpZCBieSBzZXR0aW5nIGFsbCBjZWxscyB0byBudWxsXG4gICAgZ3JpZC5mb3JFYWNoKChyb3csIHJvd0luZGV4KSA9PiB7XG4gICAgICByb3cuZm9yRWFjaCgoXywgY29sSW5kZXgpID0+IHtcbiAgICAgICAgZ3JpZFtyb3dJbmRleF1bY29sSW5kZXhdID0gbnVsbDtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gUmVhc3NpZ24gZW1wdHkgYXJyYXlzIHRvIGNsZWFyIHRoZSBjb250ZW50cyBvZiBhdHRhY2tlZENvb3JkaW5hdGVzIGFuZCBtaXNzZWRBdHRhY2tzXG4gICAgYXR0YWNrZWRDb29yZGluYXRlcyA9IFtdO1xuICAgIG1pc3NlZEF0dGFja3MgPSBbXTtcbiAgfTtcblxuICBjb25zdCBnZXRNaXNzZWRBdHRhY2tzID0gKCkgPT4gbWlzc2VkQXR0YWNrcztcblxuICBjb25zdCBnZXRBdHRhY2tlZENvb3JkaW5hdGVzID0gKCkgPT4gYXR0YWNrZWRDb29yZGluYXRlcztcblxuICByZXR1cm4ge1xuICAgIGdldEdyaWQsXG4gICAgcGxhY2VTaGlwLFxuICAgIGdldFNoaXBzLFxuICAgIGdldEFsbFNoaXBzLFxuICAgIGdldFNoaXBDb29yZGluYXRlcyxcbiAgICByZWNlaXZlQXR0YWNrLFxuICAgIGdldE1pc3NlZEF0dGFja3MsXG4gICAgZ2V0QXR0YWNrZWRDb29yZGluYXRlcyxcbiAgICBhbGxTaGlwc1N1bmssXG4gICAgcmVzZXQsXG4gIH07XG59O1xuXG5leHBvcnQgY29uc3QgUGxheWVyRmFjdG9yeSA9IChuYW1lLCBjdXJyZW50RGlyZWN0aW9uLCBsYXN0SGl0Q29vcmRpbmF0ZSkgPT4ge1xuICBjb25zdCBhdHRhY2tlZENvb3JkaW5hdGVzID0gbmV3IFNldCgpOyAvLyBTZXQgdG8ga2VlcCB0cmFjayBvZiBhdHRhY2tlZCBjb29yZGluYXRlc1xuXG4gIGNvbnN0IGdldE5leHRDb29yZGluYXRlSW5EaXJlY3Rpb24gPSAoY29vcmRpbmF0ZSwgZGlyZWN0aW9uKSA9PiB7XG4gICAgY29uc3QgW2NvbExldHRlciwgcm93TnVtYmVyXSA9IGNvb3JkaW5hdGU7XG4gICAgY29uc3Qgcm93ID0gcGFyc2VJbnQocm93TnVtYmVyLCAxMCk7XG4gICAgY29uc3QgY29sID0gY29sTGV0dGVyLmNoYXJDb2RlQXQoMCkgLSA2NTtcblxuICAgIGxldCBuZXh0Um93ID0gcm93O1xuICAgIGxldCBuZXh0Q29sID0gY29sO1xuXG4gICAgc3dpdGNoIChkaXJlY3Rpb24pIHtcbiAgICAgIGNhc2UgXCJ1cFwiOlxuICAgICAgICBuZXh0Um93IC09IDE7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcImRvd25cIjpcbiAgICAgICAgbmV4dFJvdyArPSAxO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJsZWZ0XCI6XG4gICAgICAgIG5leHRDb2wgLT0gMTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwicmlnaHRcIjpcbiAgICAgICAgbmV4dENvbCArPSAxO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHJldHVybiBGYWN0b3J5SGVscGVycy5jb252ZXJ0VG9BbHBoYW51bWVyaWMoW25leHRSb3csIG5leHRDb2xdKTtcbiAgfTtcblxuICBjb25zdCBnZXROZXh0RGlyZWN0aW9ucyA9ICgpID0+IHtcbiAgICBjb25zdCBkaXJlY3Rpb25zID0gW1widXBcIiwgXCJkb3duXCIsIFwibGVmdFwiLCBcInJpZ2h0XCJdO1xuICAgIGlmICghY3VycmVudERpcmVjdGlvbikge1xuICAgICAgLy8gSWYgY3VycmVudERpcmVjdGlvbiBpcyBub3Qgc2V0LCBzaHVmZmxlIHRoZSBkaXJlY3Rpb25zIHRvIHRyeSB0aGVtIGluIHJhbmRvbSBvcmRlclxuICAgICAgZm9yIChsZXQgaSA9IGRpcmVjdGlvbnMubGVuZ3RoIC0gMTsgaSA+IDA7IGkgLT0gMSkge1xuICAgICAgICBjb25zdCBqID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGkgKyAxKSk7XG4gICAgICAgIFtkaXJlY3Rpb25zW2ldLCBkaXJlY3Rpb25zW2pdXSA9IFtkaXJlY3Rpb25zW2pdLCBkaXJlY3Rpb25zW2ldXTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSWYgY3VycmVudERpcmVjdGlvbiBpcyBzZXQsIG1vdmUgaXQgdG8gdGhlIGVuZCBvZiB0aGUgbGlzdCwgc28gaXQgd2lsbCB0cnkgb3RoZXIgZGlyZWN0aW9ucyBmaXJzdFxuICAgICAgY29uc3QgaW5kZXggPSBkaXJlY3Rpb25zLmluZGV4T2YoY3VycmVudERpcmVjdGlvbik7XG4gICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgIGRpcmVjdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgZGlyZWN0aW9ucy5wdXNoKGN1cnJlbnREaXJlY3Rpb24pO1xuICAgICAgICBjb25zb2xlLmxvZyhjdXJyZW50RGlyZWN0aW9uKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRpcmVjdGlvbnM7XG4gIH07XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNoYWRvd1xuICBjb25zdCBhdHRhY2sgPSAoZW5lbXlHYW1lYm9hcmQsIGxhc3RIaXRDb29yZGluYXRlLCBjdXJyZW50RGlyZWN0aW9uKSA9PiB7XG4gICAgY29uc3QgZ3JpZFNpemUgPSBlbmVteUdhbWVib2FyZC5nZXRHcmlkKCkubGVuZ3RoO1xuICAgIGNvbnN0IHZhbGlkQ29vcmRpbmF0ZXMgPSBGYWN0b3J5SGVscGVycy5nZXRBbGxWYWxpZENvb3JkaW5hdGVzKGdyaWRTaXplKTtcblxuICAgIGxldCBjb29yZGluYXRlID0gXCJcIjtcblxuICAgIGNvbnNvbGUubG9nKGAke2N1cnJlbnREaXJlY3Rpb259IDogJHtsYXN0SGl0Q29vcmRpbmF0ZX1gKTtcblxuICAgIGlmIChsYXN0SGl0Q29vcmRpbmF0ZSAmJiBjdXJyZW50RGlyZWN0aW9uKSB7XG4gICAgICAvLyBHZXQgdGhlIG5leHQgZGlyZWN0aW9ucyB0byB0cnlcbiAgICAgIGNvbnN0IGRpcmVjdGlvbnNUb1RyeSA9IGdldE5leHREaXJlY3Rpb25zKCk7XG5cbiAgICAgIC8vIFRyeSBlYWNoIGRpcmVjdGlvbiB1bnRpbCBhIHZhbGlkIGNvb3JkaW5hdGUgaXMgZm91bmRcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLXN5bnRheFxuICAgICAgZm9yIChjb25zdCBkaXJlY3Rpb24gb2YgZGlyZWN0aW9uc1RvVHJ5KSB7XG4gICAgICAgIGNvb3JkaW5hdGUgPSBnZXROZXh0Q29vcmRpbmF0ZUluRGlyZWN0aW9uKGxhc3RIaXRDb29yZGluYXRlLCBkaXJlY3Rpb24pO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgbmV4dCBjb29yZGluYXRlIGluIHRoZSBjdXJyZW50IGRpcmVjdGlvbiBpcyBhIHZhbGlkLCB1bmF0dGFja2VkIGNvb3JkaW5hdGVcbiAgICAgICAgaWYgKFxuICAgICAgICAgIHZhbGlkQ29vcmRpbmF0ZXMuaW5jbHVkZXMoY29vcmRpbmF0ZSkgJiZcbiAgICAgICAgICAhYXR0YWNrZWRDb29yZGluYXRlcy5oYXMoY29vcmRpbmF0ZSkgJiZcbiAgICAgICAgICAhZW5lbXlHYW1lYm9hcmQuZ2V0QXR0YWNrZWRDb29yZGluYXRlcygpLmluY2x1ZGVzKGNvb3JkaW5hdGUpXG4gICAgICAgICkge1xuICAgICAgICAgIC8vIEFkZCB0aGUgYXR0YWNrZWQgY29vcmRpbmF0ZSB0byB0aGUgcGxheWVyJ3Mgc2V0IG9mIGF0dGFja2VkIGNvb3JkaW5hdGVzXG4gICAgICAgICAgYXR0YWNrZWRDb29yZGluYXRlcy5hZGQoY29vcmRpbmF0ZSk7XG4gICAgICAgICAgLy8gVXBkYXRlIGxhc3RIaXRDb29yZGluYXRlIGFuZCBjdXJyZW50RGlyZWN0aW9uXG5cbiAgICAgICAgICBsYXN0SGl0Q29vcmRpbmF0ZSA9IGNvb3JkaW5hdGU7XG4gICAgICAgICAgY3VycmVudERpcmVjdGlvbiA9IGRpcmVjdGlvbjtcbiAgICAgICAgICByZXR1cm4gY29vcmRpbmF0ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIG5vIHZhbGlkIG5leHQgY29vcmRpbmF0ZSBpbiB0aGUgY3VycmVudCBkaXJlY3Rpb24sIG9yIGlmIHRoZSBsYXN0SGl0Q29vcmRpbmF0ZSBvciBjdXJyZW50RGlyZWN0aW9uIGlzIG5vdCBzZXQsXG4gICAgLy8gYXR0YWNrIHJhbmRvbWx5IGxpa2UgYmVmb3JlXG4gICAgZG8ge1xuICAgICAgY29uc3QgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB2YWxpZENvb3JkaW5hdGVzLmxlbmd0aCk7XG4gICAgICBjb29yZGluYXRlID0gdmFsaWRDb29yZGluYXRlc1tyYW5kb21JbmRleF07XG4gICAgfSB3aGlsZSAoXG4gICAgICBhdHRhY2tlZENvb3JkaW5hdGVzLmhhcyhjb29yZGluYXRlKSB8fFxuICAgICAgZW5lbXlHYW1lYm9hcmQuZ2V0QXR0YWNrZWRDb29yZGluYXRlcygpLmluY2x1ZGVzKGNvb3JkaW5hdGUpXG4gICAgKTtcblxuICAgIC8vIEFkZCB0aGUgYXR0YWNrZWQgY29vcmRpbmF0ZSB0byB0aGUgcGxheWVyJ3Mgc2V0IG9mIGF0dGFja2VkIGNvb3JkaW5hdGVzXG4gICAgYXR0YWNrZWRDb29yZGluYXRlcy5hZGQoY29vcmRpbmF0ZSk7XG5cbiAgICByZXR1cm4gY29vcmRpbmF0ZTtcbiAgfTtcblxuICBjb25zdCBnZXRBdHRhY2tlZFNldCA9ICgpID0+IGF0dGFja2VkQ29vcmRpbmF0ZXM7XG5cbiAgY29uc3QgY2xlYXJTZXQgPSAoKSA9PiB7XG4gICAgYXR0YWNrZWRDb29yZGluYXRlcy5jbGVhcigpO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgbmFtZSxcbiAgICBsYXN0SGl0Q29vcmRpbmF0ZSxcbiAgICBjdXJyZW50RGlyZWN0aW9uLFxuICAgIGF0dGFjayxcbiAgICBnZXRBdHRhY2tlZFNldCxcbiAgICBjbGVhclNldCxcbiAgfTtcbn07XG4iLCJleHBvcnQgY29uc3QgRmFjdG9yeUhlbHBlcnMgPSAoKCkgPT4ge1xuICBjb25zdCB2YWxpZENvb3JkaW5hdGVzID0gW107XG5cbiAgY29uc3QgY29udmVydFRvSW5kaWNlcyA9IChjb29yZGluYXRlKSA9PiB7XG4gICAgY29uc3QgY29sdW1uID0gY29vcmRpbmF0ZS5jaGFyQ29kZUF0KDApIC0gNjU7IC8vIENvbnZlcnQgY29sdW1uIGxldHRlciB0byBpbmRleFxuICAgIGNvbnN0IHJvdyA9IHBhcnNlSW50KGNvb3JkaW5hdGUuc2xpY2UoMSksIDEwKTsgLy8gQ29udmVydCByb3cgbnVtYmVyIHRvIGluZGV4IHdpdGggcmFkaXggMTBcbiAgICByZXR1cm4gW3JvdywgY29sdW1uXTtcbiAgfTtcblxuICBjb25zdCBjb252ZXJ0VG9BbHBoYW51bWVyaWMgPSAoW3JvdywgY29sdW1uXSkgPT4ge1xuICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNvbHVtbiArIDY1KTsgLy8gQ29udmVydCBjb2x1bW4gaW5kZXggdG8gbGV0dGVyXG4gICAgcmV0dXJuIGNvb3JkaW5hdGUgKyByb3c7IC8vIENvbnZlcnQgcm93IGluZGV4IHRvIG51bWJlclxuICB9O1xuXG4gIGNvbnN0IGdldEFsbFZhbGlkQ29vcmRpbmF0ZXMgPSAoZ3JpZFNpemUpID0+IHtcbiAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCBncmlkU2l6ZTsgcm93ICs9IDEpIHtcbiAgICAgIGZvciAobGV0IGNvbCA9IDA7IGNvbCA8IGdyaWRTaXplOyBjb2wgKz0gMSkge1xuICAgICAgICBjb25zdCBhbHBoYW51bWVyaWNDb29yZGluYXRlID0gY29udmVydFRvQWxwaGFudW1lcmljKFtyb3csIGNvbF0pO1xuICAgICAgICB2YWxpZENvb3JkaW5hdGVzLnB1c2goYWxwaGFudW1lcmljQ29vcmRpbmF0ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHZhbGlkQ29vcmRpbmF0ZXM7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBjb252ZXJ0VG9JbmRpY2VzLFxuICAgIGNvbnZlcnRUb0FscGhhbnVtZXJpYyxcbiAgICBnZXRBbGxWYWxpZENvb3JkaW5hdGVzLFxuICB9O1xufSkoKTtcblxuZXhwb3J0IGNvbnN0IEFwcEhlbHBlcnMgPSAoKCkgPT4ge1xuICBjb25zdCBzaGlwVHlwZXMgPSBbXG4gICAgeyB0eXBlOiBcImNhcnJpZXJcIiwgbGVuZ3RoOiA1IH0sXG4gICAgeyB0eXBlOiBcImJhdHRsZXNoaXBcIiwgbGVuZ3RoOiA0IH0sXG4gICAgeyB0eXBlOiBcImRlc3Ryb3llclwiLCBsZW5ndGg6IDMgfSxcbiAgICB7IHR5cGU6IFwic3VibWFyaW5lXCIsIGxlbmd0aDogMyB9LFxuICAgIHsgdHlwZTogXCJwYXRyb2wgYm9hdFwiLCBsZW5ndGg6IDIgfSxcbiAgXTtcblxuICBjb25zdCB0b2dnbGVNb2RhbCA9IChtb2RhbCwgY2hvaWNlKSA9PiB7XG4gICAgY29uc3QgdG9nZ2xlZE1vZGFsID0gbW9kYWw7XG5cbiAgICBjb25zdCBvdmVybGF5ID0gbW9kYWwuY2xvc2VzdChcIi5vdmVybGF5XCIpO1xuICAgIGNvbnN0IGRpc3BsYXlWYWx1ZSA9IGNob2ljZSA9PT0gXCJzaG93XCIgPyBcImZsZXhcIiA6IFwibm9uZVwiO1xuXG4gICAgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gZGlzcGxheVZhbHVlO1xuICAgIHRvZ2dsZWRNb2RhbC5zdHlsZS5kaXNwbGF5ID0gZGlzcGxheVZhbHVlO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgc2hpcFR5cGVzLFxuICAgIHRvZ2dsZU1vZGFsLFxuICB9O1xufSkoKTtcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDM4MCk7XG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc3Nik7XG4iXSwibmFtZXMiOlsiY29udGFpbmVyRWxlbWVudCIsImNvbnRhaW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50Iiwicm93IiwiY29sIiwiY29vcmRpbmF0ZSIsImNvbnZlcnRUb0FscGhhbnVtZXJpYyIsInNxdWFyZSIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJkYXRhc2V0IiwiYXBwZW5kQ2hpbGQiLCJldmVudExpc3RlbmVycyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwibGlzdGVuZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnRUeXBlIiwiaGFuZGxlciIsIndpbm5lciIsImNsYXNzTmFtZSIsInBsYXllckdhbWVib2FyZCIsImNvbXB1dGVyR2FtZWJvYXJkIiwiY29tcHV0ZXIiLCJjdXJyZW50U2hpcEluZGV4Iiwic2hpcFBsYWNlbWVudE1vZGUiLCJpc1ZlcnRpY2FsIiwicGxheWVyQXR0YWNrIiwiZSIsInRhcmdldCIsImdldEF0dGFja2VkQ29vcmRpbmF0ZXMiLCJpbmNsdWRlcyIsInJlY2VpdmVBdHRhY2siLCJhbGxTaGlwc1N1bmsiLCJ0b2dnbGVNb2RhbCIsImF0dGFjayIsImxhc3RIaXRDb29yZGluYXRlIiwiY3VycmVudERpcmVjdGlvbiIsImF0dGFja2VkU2hpcCIsImNvbXB1dGVyQXR0YWNrIiwicm90YXRlU2hpcHMiLCJsZW5ndGgiLCJzaGlwVHlwZXMiLCJzdGFydFJvdyIsInN0YXJ0Q29sIiwiY29udmVydFRvSW5kaWNlcyIsIkFycmF5IiwiZnJvbSIsIl8iLCJpIiwiaW5pdGlhbFNxdWFyZSIsImhvdmVyZWRTcXVhcmUiLCJyZW1vdmUiLCJzaGlwQ29vcmRpbmF0ZXMiLCJzaGlwIiwicGxhY2VTaGlwIiwic2hpcFR5cGUiLCJncmlkU2l6ZSIsImNvb3JkaW5hdGVzIiwicGxhY2VkIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiZ2V0U2hpcENvb3JkaW5hdGVzIiwiY29udmVydGVkQ29vcmRpbmF0ZSIsInBsYWNlQ29tcHV0ZXJTaGlwcyIsInNldFRpbWVvdXQiLCJuZXh0U2hpcFR5cGUiLCJ0eXBlIiwiaW5pdCIsInJlc2V0IiwiY2xlYXJTZXQiLCJTaGlwRmFjdG9yeSIsImhpdHMiLCJoaXQiLCJpc1N1bmsiLCJHYW1lYm9hcmRGYWN0b3J5IiwiZ3JpZCIsImZpbGwiLCJhdHRhY2tlZENvb3JkaW5hdGVzIiwibWlzc2VkQXR0YWNrcyIsImdldFNoaXBzIiwic2hpcHMiLCJjZWxsIiwicHVzaCIsImdldEdyaWQiLCJ3aXRoaW5Cb3VuZGFyaWVzIiwiZXZlcnkiLCJjb25mbGljdHMiLCJzb21lIiwiYWRqYWNlbnRDb25mbGljdHMiLCJhZGpSb3ciLCJhZGpDb2wiLCJzaGlwSW5mbyIsImdldEFsbFNoaXBzIiwiY29sdW1uTGV0dGVyIiwicm93TnVtYmVyIiwicGFyc2VJbnQiLCJjaGFyQ29kZUF0IiwiZ2V0TWlzc2VkQXR0YWNrcyIsInJvd0luZGV4IiwiY29sSW5kZXgiLCJQbGF5ZXJGYWN0b3J5IiwibmFtZSIsIlNldCIsImdldE5leHRDb29yZGluYXRlSW5EaXJlY3Rpb24iLCJkaXJlY3Rpb24iLCJjb2xMZXR0ZXIiLCJuZXh0Um93IiwibmV4dENvbCIsImdldE5leHREaXJlY3Rpb25zIiwiZGlyZWN0aW9ucyIsImluZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsImNvbnNvbGUiLCJsb2ciLCJqIiwiZW5lbXlHYW1lYm9hcmQiLCJ2YWxpZENvb3JkaW5hdGVzIiwiZ2V0QWxsVmFsaWRDb29yZGluYXRlcyIsImRpcmVjdGlvbnNUb1RyeSIsImhhcyIsImdldEF0dGFja2VkU2V0IiwiY2xlYXIiLCJGYWN0b3J5SGVscGVycyIsImNvbHVtbiIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsInNsaWNlIiwiYWxwaGFudW1lcmljQ29vcmRpbmF0ZSIsIkFwcEhlbHBlcnMiLCJtb2RhbCIsImNob2ljZSIsInRvZ2dsZWRNb2RhbCIsImRpc3BsYXlWYWx1ZSIsImNsb3Nlc3QiLCJzdHlsZSIsImRpc3BsYXkiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImQiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiXSwic291cmNlUm9vdCI6IiJ9